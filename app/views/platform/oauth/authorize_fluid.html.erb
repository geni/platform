<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
  <meta content="width=device-width; initial-scale=1.0; maximum-scale=1.0; minimum-scale=1.0; user-scalable=0;" name="viewport">
  
 <link href="/stylesheets/components.css?1309982554" media="" rel="stylesheet" type="text/css">
<link href="/stylesheets/layout.css?1307049673" media="" rel="stylesheet" type="text/css">
<link href="/stylesheets/common.css?1310061236" media="" rel="stylesheet" type="text/css">
<link href="/stylesheets/temp.css?1305836734" media="" rel="stylesheet" type="text/css">
<link href="/stylesheets/header.css?1309297014" media="" rel="stylesheet" type="text/css">
    
</head>
<body>
 
 
 	<div class="page_hd hd">
 	  <div style="float:right;padding-top:15px;font-weight:bold;padding-right:10px;">
		  <%=link_to(tr("Not {user}?", "", :user => [Platform::Config.current_user, :name]), :controller => "/login", :action => :out, :display => params[:display], :client_id => @client_application.id)%>
		</div>
    <div href="/" class="i logo module"></div>
  </div>
  <div class="page_bd bd ">


	<div class="mhm mvl outset" style="margin:50px auto;width:625px">
		<div class="inner">
    
			<div class="module mbl">
				<div class="mbs" style="font-size:16px;"><%=trl("[bold: {application}] would like permission to access your Geni account.","", :application => @client_application.name)%></div>
				<div class="quiet">
					<%= trl("Only allow access if you trust this application with your Geni Information.") %>
				</div>
			</div>
			
			<div class="module pal mbl">
				<div class="line">
					<div class="unit size_3of5">
						<div class="media mrl">
							<%=image_tag(Platform::Config.user_mugshot(Platform::Config.current_user), :class => "img")%>
							<div class="bd">
								<h4><%= trl("This application will have access to:") %></h4>
								<p class="quiet mbl">
									<%=trl("Your name, profile picture, gender, family, photos and any other information available through your user account.")%>
								</p>
                <%- if @client_application.tos_required? -%>
                  <div class='platform-authorize__tos-row' style='display:none;'>
                    <%= tr('You must approve the Terms of Service and Privacy Policy', 'Client application error text') %>
                  </div>
                <%- end -%>
								<div class='platform-authorize__button-row'>
								 <button class="blue super large button" onClick="$('authorize').value = 1; doAccept()">
										<%=trl('Authorize', 'Client application action label')%>
								 </button>
								 <button class="white super large button"  onClick="$('authorize').value = 0; $('auth_form').submit()">
										<%=trl("Cancel", 'Client application action label')%>
								 </button>
								</div>
							</div>
						</div>
					</div>
					<div class="unit size_2of5 last_unit">
						<div class="mll pll" style="border-left:solid 1px #ddd">
							<div class="mbm">
								<%= link_to(image_tag(@client_application.logo_url), {:controller=> "/platform/apps", :action => :view, :id => @client_application.id}, :target => "_blank") %><br>
							</div>
							<div class="mbs">
								<%= link_to(h(@client_application.name), {:controller=> "/platform/apps", :action => :view, :id => @client_application.id}, :target => "_blank") %><br>
							</div>
							<div>
							 	<%= platform_app_rank_tag(@client_application, 95) %>
							</div>				
						</div>
					</div>
				</div>
			</div>
				
			<div class="module small quiet prose checkbox-wrapper">
        <%- if @client_application.tos_required? -%>
          <input id='tos-accepted' type='checkbox'/>
        <%- end -%>
        <%= tr(@client_application.terms_statement_tr_label, "",
               :application  => @client_application.name,
               :link_tos     => lambda{|text| link_to(text, @client_application.terms_of_service_url, :target => "_blank") },
               :link_privacy => lambda{|text| link_to(text, @client_application.privacy_policy_url,   :target => "_blank") }) -%>
			</div>

							
		</div>
	</div>

</div>
<%= render :partial => "authorize_form" %>



<script>
  function $(element_id) {
    if (typeof element_id == 'string') return document.getElementById(element_id);
    return element_id;
  }
	
  function doAccept() {
    if( !$('tos-accepted').checked ) {
      $$('.platform-authorize__tos-row').first().show();
      return false;
    } else {
      return $('auth_form').submit();
    }
  }

</script>  

  </div>


</body>
</html>

